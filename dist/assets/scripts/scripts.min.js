angular.module("fashion",["fashion.controllers","fashion.services","fashion.directives","fashion.filters","ui.router","ngAnimate","ngSanitize","angular-storage"]).run(["$rootScope","$state",function(e,t){e.$on("$stateChangeError",function(e,n,r,o,i,a){"AUTH_REQUIRED"===a&&t.go("app.search")})}]).config(["$sceDelegateProvider",function(e){e.resourceUrlWhitelist(["self"])}]).run(["$rootScope","$state",function(e,t){e.stateIsLoading=!0,e.$on("$stateChangeStart",function(){e.stateIsLoading=!0})}]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,t,n){e.state("app",{url:"/app","abstract":!0,views:{header:{templateUrl:"templates/app.html",controller:"AppCtrl"}}}).state("app.results",{url:"search/:key/results",views:{main:{templateUrl:"templates/results.html",controller:"ResultsCtrl"}}}).state("app.search",{url:"/search",views:{main:{templateUrl:"templates/search.html",controller:"SearchCtrl"}}}),t.otherwise(function(){return"/app/search"})}]),angular.module("fashion.controllers",["fashion.services","fashion.filters"]).controller("AppCtrl",["$scope","$log","$state","$stateParams","$rootScope","$http","$anchorScroll",function(e,t,n,r,o,i,a){e.refreshState=function(){var t=n.current.name.replace("app.","");e.currentState=t.replace("_"," ")},e.showNavSteps=!0,e.hideNavSteps=function(){e.showNavSteps=!e.showNavSteps}}]).controller("SearchCtrl",["$scope","$sce","$interval","Flickr",function(e,t,n,r){this.searchTags=[],this.userId="",this.search=function(e){e&&r.searchTags(this.searchTags,this.userId).then(function(e){$state.go("app.results",{key:e})})}}]).controller("ResultsCtrl",["$scope","$http","$stateParams","Flickr",function(e,t,n,r){r.retrieveSearch(n.key).then(function(e){this.results=e})}]),angular.module("fashion.directives",[]).directive("tagEnter",function(){return function(e,t,n){t.bind("keydown keypress",function(t){var r=t.which||t.keyCode;13===r&&(e.$apply(function(){e.$eval(n.dlEnterKey)}),t.preventDefault())})}}).directive("threeKeys",function(){return function(e,t,n){var r=0;t.bind("keydown keypress",function(t){r++,r>=3&&(e.$apply(function(){e.$eval(n.myOnKeyDownCall)}),t.preventDefault())})}}).directive("myAutocomplete",function(){return{require:"ngModel",replace:!0,scope:{ngModel:"=",address1:"=",city:"=",state:"=",country:"=",zip:"="},template:'<input class="form-control" type="text" data-tap-disabled>',link:function(e,t,n,r){var o={},i=new google.maps.places.Autocomplete(t[0],o);google.maps.event.addListener(i,"place_changed",function(){e.$apply(function(){var n=i.getPlace(),o=n.address_components;e.address1=o[0].short_name+" "+o[1].short_name,e.city=o[3].short_name,e.state=o[5].short_name,e.country=o[6].long_name,e.zip=o[7].short_name,r.$setViewValue(t.val())})})}}}).directive("backImg",function(){return function(e,t,n){var r=n.backImg;t.css({"background-image":"url("+r+")","background-size":"cover"})}}).directive("disabletap",["$timeout",function(e){return{link:function(){e(function(){container=document.getElementsByClassName("pac-container"),angular.element(container).attr("data-tap-disabled","true"),angular.element(container).on("click",function(){document.getElementById("type-selector").blur()})},500)}}}]).directive("onLongPress",["$timeout",function(e){return{restrict:"A",link:function(t,n,r){n.bind("touchstart",function(n){t.longPress=!0,e(function(){t.longPress&&t.$apply(function(){t.$eval(r.onLongPress)})},600)}),n.bind("touchend",function(e){t.longPress=!1,r.onTouchEnd&&t.$apply(function(){t.$eval(r.onTouchEnd)})})}}}]).directive("myDirective",function(){return{restrict:"EA",scope:{title:"@"},templateUrl:"mytemplate.html",controller:controllerFunction,link:function(e,t,n){}}}).directive("ngDrag",["$document",function(e){return{link:function(t,n,r){function o(e){l=e.pageY-c,s=e.pageX-a,n.css({top:l+"px",left:s+"px"})}function i(){e.off("mousemove",o),e.off("mouseup",i)}var a=0,c=0,s=0,l=0;n.on("mousedown",function(t){t.preventDefault(),a=t.pageX-s,c=t.pageY-l,e.on("mousemove",o),e.on("mouseup",i)})}}}]),angular.module("fashion.filters",[]).filter("OWMIcon",function(){return function(e){return"http://openweathermap.org/img/w/"+e+".png"}}).filter("kelvinFormat",function(){return function(e,t){var n;return"C"==t?(n=Math.floor(e-273.15),n+" "+t):"F"==t?(n=Math.floor(9*e/5-459.67),n+" "+t):void 0}}).filter("capitalise",function(){return function(e){return e?e.charAt(0).toUpperCase()+e.substr(1).toLowerCase():""}}).filter("kelvin",function(){return function(e,t){var n;return"C"==t?n=Math.floor(e-273.15):"F"==t?n=Math.floor(9*e/5-459.67):void 0}}).filter("kph",function(){return function(e){var t=Math.floor(3600*e/1e3);return t+" kph"}}),jQuery.expr.filters.offscreen=function(e){var t=e.getBoundingClientRect();return t.x+t.width<0||t.y+t.height<0||t.x>window.innerWidth||t.y>window.innerHeight},function(e){var t=e(window);e.fn.visible=function(n,r,o,i){if(!(this.length<1)){o=o||"both";var a=this.length>1?this.eq(0):this,c="undefined"!=typeof i&&null!==i,s=c?e(i):t,l=c?s.position():0,u=a.get(0),f=s.outerWidth(),p=s.outerHeight(),h=r!==!0||u.offsetWidth*u.offsetHeight;if("function"==typeof u.getBoundingClientRect){var d=u.getBoundingClientRect(),g=c?d.top-l.top>=0&&d.top<p+l.top:d.top>=0&&d.top<p,m=c?d.bottom-l.top>0&&d.bottom<=p+l.top:d.bottom>0&&d.bottom<=p,v=c?d.left-l.left>=0&&d.left<f+l.left:d.left>=0&&d.left<f,$=c?d.right-l.left>0&&d.right<f+l.left:d.right>0&&d.right<=f,y=n?g||m:g&&m,k=n?v||$:v&&$,y=d.top<0&&d.bottom>p||y,k=d.left<0&&d.right>f||k;if("both"===o)return h&&y&&k;if("vertical"===o)return h&&y;if("horizontal"===o)return h&&k}else{var w=c?0:l,b=w+p,C=s.scrollLeft(),S=C+f,E=a.position(),P=E.top,_=P+a.height(),R=E.left,F=R+a.width(),U=n===!0?_:P,A=n===!0?P:_,I=n===!0?F:R,L=n===!0?R:F;if("both"===o)return!!h&&A<=b&&U>=w&&L<=S&&I>=C;if("vertical"===o)return!!h&&A<=b&&U>=w;if("horizontal"===o)return!!h&&L<=S&&I>=C}}}}(jQuery);const flickr={KEY:"0dcdaf57835fe56c55753e242a947db9",SECRET:"97807172640e45ee",URL:"https://api.flickr.com/services"};var Flickr=require("flickr-sdk");angular.module("fashion.services",[]).factory("Flickr",["$http","$q","$cacheFactory",function(e,t,n){function r(n,r){var o=flickr.URL+"?api_key="+flickr.KEY+"&method=flickr.photos.search&tags="+n;r&&(o+="&user_id="+r);var i={method:"POST",url:o},a=t.defer();return e(i).then(function(e){var t=moment.unix();serches.put(e.data),a.resolve(t)}),a.promise}function o(e){var n=t.defer(),r=i.get(e);return r?n.resolve(r):n.resolve([]),n.promise}var i=n("searches");new Flickr;return{searchTags:function(e,t){return r(e,t)},retrieveSearch:function(e){return o(e)}}}]);
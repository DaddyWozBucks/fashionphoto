angular.module("fashion",["fashion.controllers","fashion.services","fashion.directives","fashion.filters","ui.router","ngAnimate","ngSanitize","angular-storage"]).run(["$rootScope","$state",function(t,e){t.$on("$stateChangeError",function(t,n,r,o,i,a){"AUTH_REQUIRED"===a&&e.go("app.search")})}]).config(["$sceDelegateProvider",function(t){t.resourceUrlWhitelist(["self"])}]).run(["$rootScope","$state",function(t,e){t.stateIsLoading=!0,t.$on("$stateChangeStart",function(){t.stateIsLoading=!0})}]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(t,e,n){t.state("app",{url:"/app","abstract":!0,views:{header:{templateUrl:"templates/app.html",controller:"AppCtrl"}}}).state("app.results",{url:"search/:key/results",views:{main:{templateUrl:"templates/results.html",controller:"ResultsCtrl"}}}).state("app.search",{url:"/search",views:{main:{templateUrl:"templates/search.html",controller:"SearchCtrl"}}}),e.otherwise(function(){return"/app/search"})}]),angular.module("fashion.controllers",["fashion.services","fashion.filters"]).controller("AppCtrl",["$scope","$log","$state","$stateParams","$rootScope","$http","$anchorScroll",function(t,e,n,r,o,i,a){t.refreshState=function(){var e=n.current.name.replace("app.","");t.currentState=e.replace("_"," ")},t.showNavSteps=!0,t.hideNavSteps=function(){t.showNavSteps=!t.showNavSteps}}]).controller("SearchCtrl",["$scope","$sce","$interval","Flickr",function(t,e,n,r){this.searchTags=[],this.userId="",this.search=function(t){t&&r.searchTags(this.searchTags,this.userId).then(function(t){$state.go("app.results",{key:t})})}}]).controller("ResultsCtrl",["$scope","$http","$stateParams","Flickr",function(t,e,n,r){r.retrieveSearch(n.key).then(function(t){this.results=t})}]),angular.module("fashion.directives",[]).directive("tagEnter",function(){return function(t,e,n){e.bind("keydown keypress",function(e){var r=e.which||e.keyCode;13===r&&(t.$apply(function(){t.$eval(n.dlEnterKey)}),e.preventDefault())})}}).directive("threeKeys",function(){return function(t,e,n){var r=0;e.bind("keydown keypress",function(e){r++,r>=3&&(t.$apply(function(){t.$eval(n.myOnKeyDownCall)}),e.preventDefault())})}}).directive("myAutocomplete",function(){return{require:"ngModel",replace:!0,scope:{ngModel:"=",address1:"=",city:"=",state:"=",country:"=",zip:"="},template:'<input class="form-control" type="text" data-tap-disabled>',link:function(t,e,n,r){var o={},i=new google.maps.places.Autocomplete(e[0],o);google.maps.event.addListener(i,"place_changed",function(){t.$apply(function(){var n=i.getPlace(),o=n.address_components;t.address1=o[0].short_name+" "+o[1].short_name,t.city=o[3].short_name,t.state=o[5].short_name,t.country=o[6].long_name,t.zip=o[7].short_name,r.$setViewValue(e.val())})})}}}).directive("backImg",function(){return function(t,e,n){var r=n.backImg;e.css({"background-image":"url("+r+")","background-size":"cover"})}}).directive("disabletap",["$timeout",function(t){return{link:function(){t(function(){container=document.getElementsByClassName("pac-container"),angular.element(container).attr("data-tap-disabled","true"),angular.element(container).on("click",function(){document.getElementById("type-selector").blur()})},500)}}}]).directive("onLongPress",["$timeout",function(t){return{restrict:"A",link:function(e,n,r){n.bind("touchstart",function(n){e.longPress=!0,t(function(){e.longPress&&e.$apply(function(){e.$eval(r.onLongPress)})},600)}),n.bind("touchend",function(t){e.longPress=!1,r.onTouchEnd&&e.$apply(function(){e.$eval(r.onTouchEnd)})})}}}]).directive("myDirective",function(){return{restrict:"EA",scope:{title:"@"},templateUrl:"mytemplate.html",controller:controllerFunction,link:function(t,e,n){}}}).directive("ngDrag",["$document",function(t){return{link:function(e,n,r){function o(t){l=t.pageY-c,s=t.pageX-a,n.css({top:l+"px",left:s+"px"})}function i(){t.off("mousemove",o),t.off("mouseup",i)}var a=0,c=0,s=0,l=0;n.on("mousedown",function(e){e.preventDefault(),a=e.pageX-s,c=e.pageY-l,t.on("mousemove",o),t.on("mouseup",i)})}}}]),angular.module("fashion.filters",[]).filter("OWMIcon",function(){return function(t){return"http://openweathermap.org/img/w/"+t+".png"}}).filter("kelvinFormat",function(){return function(t,e){var n;return"C"==e?(n=Math.floor(t-273.15),n+" "+e):"F"==e?(n=Math.floor(9*t/5-459.67),n+" "+e):void 0}}).filter("capitalise",function(){return function(t){return t?t.charAt(0).toUpperCase()+t.substr(1).toLowerCase():""}}).filter("kelvin",function(){return function(t,e){var n;return"C"==e?n=Math.floor(t-273.15):"F"==e?n=Math.floor(9*t/5-459.67):void 0}}).filter("kph",function(){return function(t){var e=Math.floor(3600*t/1e3);return e+" kph"}}),jQuery.expr.filters.offscreen=function(t){var e=t.getBoundingClientRect();return e.x+e.width<0||e.y+e.height<0||e.x>window.innerWidth||e.y>window.innerHeight},function(t){var e=t(window);t.fn.visible=function(n,r,o,i){if(!(this.length<1)){o=o||"both";var a=this.length>1?this.eq(0):this,c="undefined"!=typeof i&&null!==i,s=c?t(i):e,l=c?s.position():0,u=a.get(0),f=s.outerWidth(),p=s.outerHeight(),h=r!==!0||u.offsetWidth*u.offsetHeight;if("function"==typeof u.getBoundingClientRect){var d=u.getBoundingClientRect(),g=c?d.top-l.top>=0&&d.top<p+l.top:d.top>=0&&d.top<p,m=c?d.bottom-l.top>0&&d.bottom<=p+l.top:d.bottom>0&&d.bottom<=p,v=c?d.left-l.left>=0&&d.left<f+l.left:d.left>=0&&d.left<f,$=c?d.right-l.left>0&&d.right<f+l.left:d.right>0&&d.right<=f,y=n?g||m:g&&m,k=n?v||$:v&&$,y=d.top<0&&d.bottom>p||y,k=d.left<0&&d.right>f||k;if("both"===o)return h&&y&&k;if("vertical"===o)return h&&y;if("horizontal"===o)return h&&k}else{var w=c?0:l,b=w+p,C=s.scrollLeft(),S=C+f,E=a.position(),P=E.top,_=P+a.height(),R=E.left,U=R+a.width(),A=n===!0?_:P,I=n===!0?P:_,L=n===!0?U:R,T=n===!0?R:U;if("both"===o)return!!h&&I<=b&&A>=w&&T<=S&&L>=C;if("vertical"===o)return!!h&&I<=b&&A>=w;if("horizontal"===o)return!!h&&T<=S&&L>=C}}}}(jQuery);const flickr={KEY:"0dcdaf57835fe56c55753e242a947db9",SECRET:"97807172640e45ee",URL:"https://api.flickr.com/services"};angular.module("fashion.services",[]).factory("Flickr",["$http","$q","$cacheFactory",function(t,e,n){function r(n,r){var o=flickr.URL+"?api_key="+flickr.KEY+"&method=flickr.photos.search&tags="+n;r&&(o+="&user_id="+r);var i={method:"POST",url:o},a=e.defer();return t(i).then(function(t){var e=moment.unix();serches.put(t.data),a.resolve(e)}),a.promise}function o(t){var n=e.defer(),r=i.get(t);return r?n.resolve(r):n.resolve([]),n.promise}var i=n("searches");return{searchTags:function(t,e){return r(t,e)},retrieveSearch:function(t){return o(t)}}}]);